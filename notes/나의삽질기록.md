# 나의삽질기록.md

## MySQL

### 이벤트 스케줄링

![image-20181024104916867](/Users/lawrence/Library/Application Support/typora-user-images/image-20181024104916867.png)

ㄴ 특정 시간에 특정 update들을 수행하는 이벤트 



**주의점**

1. MySQL timezone 과 내 local timezone(=한국시간)이 상이함

   1. MySQL timezone을 바꿔서 프로그램의 단순화를 꾀하였으나, root 권한이 없어서 실패.
   2. 따라서, 프로시저 내에 한국 시간을 나타내는 변수를 만드는 방법으로 단순화를 꾀함
      1. 한국시간 변수 @korea_now를 만듬
      2. ![image-20181024112029643](/Users/lawrence/Library/Application Support/typora-user-images/image-20181024112029643.png)
   3. 근데 권한을 받음....
   4. 한국시간으로 변경
   5. ![image-20181024151513773](/Users/lawrence/Library/Application Support/typora-user-images/image-20181024151513773.png)

2. delimiter 설정

   1. BEGIN - END 절 안의 SQL문의 구분자가 ; 이기 때문에, delimiter를 바꿔주어야 함.

3. 이벤트 스케줄러 활성화

   1. 이벤트 스케줄러가 활성화되지 않아서 이벤트가 실행되지 않음

   2. ![image-20181024112348657](/Users/lawrence/Library/Application Support/typora-user-images/image-20181024112348657.png)

   3. ~~~mysql
      SET GLOBAL event_scheduler = ON;
      ~~~

   4. 주의 : 이벤트 권한이 있는 계정으로 할 것.



### TimeZone 설정

![image-20181024151513773](/Users/lawrence/Library/Application Support/typora-user-images/image-20181024151513773.png)

**주의점**	

1. root 권한으로 TimeZone을 변경하였으나, MySQL 재접속 시 UTC로 돌아옴; 

   1. 세션시간만 바뀌어서 그런 것

   2. ![image-20181024160814911](/Users/lawrence/Library/Application Support/typora-user-images/image-20181024160814911.png)

   3. global, session 전부 바꿔주기

      1. ~~~mysql
         SET GLOBAL time_zone = 'Asia/Seoul';
         SET time_zone = 'Asia/Seoul';
         ~~~



### 소켓 에러

~~~mysql
ERROR 2002 (HY000): Can't connect to local MySQL server through socket '/var/lib/mysql/mysql.sock' (2)
~~~

**원인**

 - MYSQL의 소켓 파일인 mysql.sock 파일이 없거나 위치가 정확하지 않음.
 - 소켓파일은 /tmp/ 디렉토리에 생성됨
 - mysql이 설치되어 있지 않음

**해결**

- 그냥 서버 잘못 들어갔던 거 였음… 





## FrontEnd

### 메인화면 노출 데이터 일부가 노출되지 않음

​	![image-20181024135700395](/Users/lawrence/Library/Application Support/typora-user-images/image-20181024135700395.png)



**원인** : API호출이 가끔 TimeOut 됨

![image-20181024135748352](/Users/lawrence/Library/Application Support/typora-user-images/image-20181024135748352.png)

**해결** : API 호출했는데 오류났으면 3번까지 재호출 해봄

![image-20181024151702673](/Users/lawrence/Library/Application Support/typora-user-images/image-20181024151702673.png)

해결은 되었으나, timeout 에러다 보니, 재호출 하는데 3초가량의 시간이 듬.



## BackEnd (API)

### 잦은 API TimeOut

![image-20181025113611260](/Users/lawrence/Library/Application Support/typora-user-images/image-20181025113611260.png)

**일반적인 원인**

1. 실제로 응답을 늦게 준 경우
2. Idle timeout에 의해 연결이 강제 종료 되는 경우
3. 패킷의 생성이 늦어지는 경우
4. DB 서버단 타임아웃



**살펴볼 곳**

1. API Gateway
   1. route가 proxy인 애들만 timeout인 걸로 보아 아닌듯
2. 리얼 DB 서버
   1. kozi에 쿼리 날리는 api들은 멀쩡한 걸로 보아 아닌듯
3. Data-Exposer
   1. 

